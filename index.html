<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ’• A Special Question For Khushi ğŸ’•</title>
    <!-- CSS externo -->
    <link rel="stylesheet" href="celebrationstyle.css">
</head>
<body>
    <!-- Floating Items Background -->
    <div class="hearts-container" id="heartsContainer"></div>

    <!-- Small Decorative Elements -->
    <div class="decoration deco-1">ğŸŒ¸</div>
    <div class="decoration deco-2">ğŸŒº</div>
    <div class="decoration deco-3">ğŸŒ·</div>
    <div class="decoration deco-4">ğŸŒ¹</div>

    <!-- Giant Teddy Bear Wrapper -->
    <div class="teddy-wrapper">
        
        <!-- Floating Hearts Above Teddy -->
        <div class="teddy-hearts">
            <span class="teddy-love">ğŸ’•</span>
            <span class="teddy-love">ğŸ’–</span>
            <span class="teddy-love">ğŸ’—</span>
        </div>

        <!-- Teddy Head (on top) -->
        <div class="teddy-head">ğŸ§¸</div>

        <!-- Teddy Body Section -->
        <div class="teddy-body">
            
            <!-- Blurred Teddy Torso Behind Card -->
            <div class="teddy-torso">ğŸ§¸</div>
            
            <!-- Left Paw -->
            <div class="teddy-paw-left">ğŸ¾</div>

            <!-- Main Card (on teddy's torso) -->
            <div class="card" id="mainCard">
                <div class="big-heart">ğŸ’–</div>
                
                <h1 class="title">Hey <span class="name-highlight">Khushi</span>! âœ¨</h1>
                <p class="subtitle">I have something very special to ask you...</p>
                
                <h2 class="question">
                    <span class="name-in-question">Khushi</span>, Will You Be My Valentine? ğŸ’•
                </h2>
                
                <div class="buttons-container" id="buttonsContainer">
                    <button class="btn btn-yes" id="yesBtn" onclick="sayYes()">Yes! ğŸ’–</button>
                    <button class="btn btn-no" id="noBtn" onmouseover="runAway()" onclick="runAway()">No</button>
                </div>

                <div class="love-note">
                    <p>Every love story is beautiful, but <span>ours is my favorite</span> ğŸ’•</p>
                </div>
            </div>

            <!-- Right Paw -->
            <div class="teddy-paw-right">ğŸ¾</div>
        </div>

        <!-- Teddy Feet (at bottom) -->
        <div class="teddy-feet">
            <div class="teddy-foot teddy-foot-left">ğŸ¾</div>
            <div class="teddy-foot teddy-foot-right">ğŸ¾</div>
        </div>
    </div>

    <!-- Hover Message -->
    <div class="hover-message" id="hoverMessage">
        Nope! That's not an option! ğŸ˜œğŸ’•
    </div>

    <script>
        // Create floating items
        function createFloatingItems() {
            const container = document.getElementById('heartsContainer');
            const items = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'â¤ï¸', 'ğŸŒ¸', 'ğŸŒº', 'âœ¨', 'ğŸ’«', 'ğŸ¦‹'];
            
            for (let i = 0; i < 25; i++) {
                const item = document.createElement('div');
                item.className = 'floating-item';
                item.innerHTML = items[Math.floor(Math.random() * items.length)];
                item.style.left = Math.random() * 100 + 'vw';
                item.style.animationDuration = (Math.random() * 12 + 12) + 's';
                item.style.animationDelay = Math.random() * 10 + 's';
                item.style.fontSize = (Math.random() * 15 + 12) + 'px';
                container.appendChild(item);
            }
        }

        // Create twinkling particles
        function createParticles() {
            const container = document.getElementById('heartsContainer');
            
            for (let i = 0; i < 40; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.top = Math.random() * 100 + 'vh';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.background = Math.random() > 0.5 ? '#ff69b4' : '#a855f7';
                container.appendChild(particle);
            }
        }

        // No button logic
        let runAwayCount = 0;
        let messageTimeout = null;

        const funnyMessages = [
            "Haha! Nice try, Khushi! ğŸ˜œğŸ’•",
            "Nope! That button is scared of you! ğŸ˜",
            "The No button says: 'I don't think so!' ğŸ’–",
            "Aww, just say Yes already! ğŸ˜˜",
            "That button is playing hard to get! ğŸ™ˆ",
            "You can't catch it, Khushi! ğŸ˜„",
            "It's running away from you! ğŸ’•",
            "The No button has left the chat! ğŸ˜",
            "Wrong button! â¡ï¸ Yes is waiting!",
            "Khushi, resistance is futile! ğŸ’˜",
            "That button is too shy! ğŸ™Š",
            "Keep trying... or just click Yes! ğŸ˜‰",
            "ğŸ§¸ The teddy wants you to say Yes!",
            "The teddy is judging you! ğŸ§¸ğŸ˜‚",
            "Make the teddy happy, Khushi! ğŸ§¸ğŸ’–"
        ];

        function runAway() {
            const noBtn = document.getElementById('noBtn');
            const yesBtn = document.getElementById('yesBtn');
            const hoverMessage = document.getElementById('hoverMessage');
            
            // Get Yes button position as anchor point
            const yesBtnRect = yesBtn.getBoundingClientRect();
            const yesCenterX = yesBtnRect.left + yesBtnRect.width / 2;
            const yesCenterY = yesBtnRect.top + yesBtnRect.height / 2;
            
            // Strict radius around Yes button (100-180px)
            const minRadius = 100;
            const maxRadius = 180;
            
            // Random angle
            const angle = Math.random() * Math.PI * 2;
            
            // Random distance within radius
            const distance = minRadius + Math.random() * (maxRadius - minRadius);
            
            // Calculate new position
            let newX = yesCenterX + Math.cos(angle) * distance;
            let newY = yesCenterY + Math.sin(angle) * distance;
            
            // Get button dimensions
            const noBtnRect = noBtn.getBoundingClientRect();
            const btnWidth = noBtnRect.width;
            const btnHeight = noBtnRect.height;
            
            // Keep within viewport with padding
            const padding = 15;
            newX = Math.max(padding, Math.min(newX - btnWidth/2, window.innerWidth - btnWidth - padding));
            newY = Math.max(padding, Math.min(newY - btnHeight/2, window.innerHeight - btnHeight - padding));
            
            // Apply position
            noBtn.style.position = 'fixed';
            noBtn.style.left = newX + 'px';
            noBtn.style.top = newY + 'px';
            noBtn.style.transform = `rotate(${Math.random() * 16 - 8}deg)`;
            noBtn.style.zIndex = '999';
            
            runAwayCount++;
            
            // Clear existing timeout
            if (messageTimeout) {
                clearTimeout(messageTimeout);
            }
            
            // Show message
            hoverMessage.textContent = funnyMessages[runAwayCount % funnyMessages.length];
            hoverMessage.classList.add('show');
            
            // Keep message visible for 4 seconds
            messageTimeout = setTimeout(() => {
                hoverMessage.classList.remove('show');
            }, 4000);
            
            // Make Yes button more attractive
            const scale = Math.min(1.25, 1 + runAwayCount * 0.025);
            yesBtn.style.transform = `scale(${scale})`;
            
            if (runAwayCount > 3) {
                yesBtn.style.boxShadow = `
                    0 10px 30px rgba(255,105,180,0.6),
                    0 0 ${15 + runAwayCount * 4}px rgba(255,105,180,0.5)
                `;
            }

            // Shrink No button after many attempts
            if (runAwayCount > 5) {
                const fontSize = Math.max(0.85, 1 - runAwayCount * 0.02);
                noBtn.style.fontSize = fontSize + 'rem';
            }
            
            // Fade No button
            if (runAwayCount > 10) {
                noBtn.style.opacity = Math.max(0.4, 1 - (runAwayCount - 10) * 0.1);
            }

            // Change text
            if (runAwayCount === 15) {
                noBtn.textContent = "Fine! ğŸ˜…";
            }
            if (runAwayCount === 20) {
                noBtn.textContent = "Ok ok! ğŸ³ï¸";
            }
        }

        function sayYes() {
            createHeartBurst();
            
            document.body.style.transition = 'all 0.5s ease';
            document.body.style.background = 'radial-gradient(circle, #a855f7 0%, #0f0c29 100%)';
            
            setTimeout(() => {
                window.location.href = 'celebration.html';
            }, 800);
        }

        function createHeartBurst() {
            const items = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'â¤ï¸', 'ğŸ§¸', 'âœ¨'];
            const yesBtn = document.getElementById('yesBtn');
            const rect = yesBtn.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for (let i = 0; i < 40; i++) {
                const item = document.createElement('div');
                item.innerHTML = items[Math.floor(Math.random() * items.length)];
                item.style.position = 'fixed';
                item.style.left = centerX + 'px';
                item.style.top = centerY + 'px';
                item.style.fontSize = (Math.random() * 25 + 15) + 'px';
                item.style.pointerEvents = 'none';
                item.style.zIndex = '1000';
                item.style.transition = 'all 0.7s ease-out';
                document.body.appendChild(item);
                
                setTimeout(() => {
                    const angle = (Math.PI * 2 * i) / 40;
                    const distance = 80 + Math.random() * 150;
                    item.style.transform = `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(0)`;
                    item.style.opacity = '0';
                }, 10);
                
                setTimeout(() => item.remove(), 800);
            }
        }

        // Initialize
        createFloatingItems();
        createParticles();

        // Console message
        console.log('%cğŸ’• A special surprise for Khushi! ğŸ’•', 'font-size: 20px; color: #ff69b4;');
        console.log('%cğŸ§¸ The teddy is rooting for you!', 'font-size: 14px; color: #a855f7;');
    </script>   
    <!-- Background Music -->
    <audio id="bgMusic" loop preload="auto">
        <source src="Where-Is-My-Husband.mp3" type="audio/mpeg">
    </audio>

    <!-- Music Control Button -->
    <button id="musicToggle" class="music-btn">ğŸµ</button>

    <style>
        .music-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff69b4, #a855f7);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            cursor: pointer;
            font-size: 22px;
            z-index: 9999;
            box-shadow: 0 5px 25px rgba(255,105,180,0.5);
            transition: all 0.3s ease;
            animation: pulse-music 2s ease-in-out infinite;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .music-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 35px rgba(255,105,180,0.7);
        }

        .music-btn.playing {
            animation: none;
            background: linear-gradient(135deg, #a855f7, #667eea);
        }

        .music-btn.playing::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid rgba(255,105,180,0.5);
            animation: music-wave 1.5s ease-out infinite;
        }

        @keyframes pulse-music {
            0%, 100% { 
                box-shadow: 0 5px 25px rgba(255,105,180,0.5);
            }
            50% { 
                box-shadow: 0 5px 25px rgba(255,105,180,0.8), 
                            0 0 0 12px rgba(255,105,180,0.15);
            }
        }

        @keyframes music-wave {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1.8);
                opacity: 0;
            }
        }

        /* Music visualizer bars when playing */
        .music-btn.playing .music-bars {
            display: flex;
        }

        .music-bars {
            display: none;
            gap: 2px;
            height: 20px;
            align-items: flex-end;
        }

        .music-bar {
            width: 3px;
            background: white;
            border-radius: 2px;
            animation: bar-dance 0.5s ease-in-out infinite;
        }

        .music-bar:nth-child(1) { height: 8px; animation-delay: 0s; }
        .music-bar:nth-child(2) { height: 16px; animation-delay: 0.1s; }
        .music-bar:nth-child(3) { height: 12px; animation-delay: 0.2s; }
        .music-bar:nth-child(4) { height: 18px; animation-delay: 0.3s; }

        @keyframes bar-dance {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.5); }
        }
    </style>

    <script>
        // ========== MUSIC CONTROLLER ==========
        const music = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicToggle');
        let isMusicPlaying = false;
        let hasMusicInteracted = false;

        // Music settings
        music.volume = 0.4;
        const startTime = 11; // Start from 10 seconds

        // Create visualizer bars
        const barsContainer = document.createElement('div');
        barsContainer.className = 'music-bars';
        for (let i = 0; i < 4; i++) {
            const bar = document.createElement('div');
            bar.className = 'music-bar';
            barsContainer.appendChild(bar);
        }
        musicBtn.innerHTML = '';
        musicBtn.appendChild(document.createTextNode('ğŸµ'));

        // Function to start music
        function startMusic() {
            music.currentTime = startTime;
            music.play().then(() => {
                isMusicPlaying = true;
                hasMusicInteracted = true;
                updateMusicButton();
            }).catch(err => {
                console.log('Music play failed:', err);
            });
        }

        // Function to update button appearance
        function updateMusicButton() {
            if (isMusicPlaying) {
                musicBtn.innerHTML = '';
                musicBtn.appendChild(barsContainer.cloneNode(true));
                musicBtn.classList.add('playing');
            } else {
                musicBtn.innerHTML = 'ğŸµ';
                musicBtn.classList.remove('playing');
            }
        }

        // Toggle music function
        function toggleMusic(e) {
            e.stopPropagation();
            
            if (!hasMusicInteracted) {
                startMusic();
                return;
            }

            if (isMusicPlaying) {
                music.pause();
                isMusicPlaying = false;
            } else {
                music.currentTime = startTime;
                music.play();
                isMusicPlaying = true;
            }
            updateMusicButton();
        }

        // Button click handler
        musicBtn.addEventListener('click', toggleMusic);

        // All possible interaction events for autoplay
        const interactionEvents = [
            'click',
            'touchstart',
            'mousemove',
            'scroll',
            'keydown'
        ];

        // Handler for first interaction
        function onFirstInteraction(e) {
            if (hasMusicInteracted) return;
            if (e.target.id === 'musicToggle') return; // Let button handle itself
            
            startMusic();
            removeInteractionListeners();
        }

        // Add interaction listeners
        function addInteractionListeners() {
            interactionEvents.forEach(event => {
                document.addEventListener(event, onFirstInteraction, { passive: true });
            });
        }

        // Remove interaction listeners
        function removeInteractionListeners() {
            interactionEvents.forEach(event => {
                document.removeEventListener(event, onFirstInteraction);
            });
        }

        // Try autoplay first
        music.currentTime = startTime;
        music.play().then(() => {
            isMusicPlaying = true;
            hasMusicInteracted = true;
            updateMusicButton();
            removeInteractionListeners();
        }).catch(() => {
            // Autoplay blocked - add listeners for first interaction
            console.log('ğŸµ Waiting for interaction to play music...');
            addInteractionListeners();
        });

        // Handle page visibility (pause when tab hidden)
        document.addEventListener('visibilitychange', () => {
            if (!hasMusicInteracted) return;
            
            if (document.hidden && isMusicPlaying) {
                music.pause();
            } else if (!document.hidden && isMusicPlaying) {
                music.play();
            }
        });

        // When song loops, restart from 9 seconds
        music.addEventListener('ended', () => {
            music.currentTime = startTime;
            music.play();
        });

        // Double-check loop reset (in case 'ended' doesn't fire with loop)
        music.addEventListener('timeupdate', () => {
            // If near the end, go back to start time
            if (music.duration - music.currentTime < 0.5) {
                music.currentTime = startTime;
            }
        });
    </script>
</body>
</html>
